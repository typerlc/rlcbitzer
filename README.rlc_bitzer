Reconstructed from ichi2.net wiki.

Original code lost in disk crash.
